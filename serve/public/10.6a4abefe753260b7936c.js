(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{jnvf:function(e,t,n){"use strict";n.r(t),n.d(t,"DepartmentModule",function(){return D});var r=n("ofXK"),a=n("tyNb"),i=n("3Pt+"),o=n("fXoL"),d=n("qXBG"),s=n("5eHb"),l=n("AwSQ"),m=n("oOf3");function p(e,t){1&e&&(o["\u0275\u0275elementStart"](0,"button",32),o["\u0275\u0275element"](1,"img",33),o["\u0275\u0275elementEnd"]())}function c(e,t){if(1&e){const e=o["\u0275\u0275getCurrentView"]();o["\u0275\u0275elementStart"](0,"button",38),o["\u0275\u0275listener"]("click",function(){o["\u0275\u0275restoreView"](e);const t=o["\u0275\u0275nextContext"]().$implicit;return o["\u0275\u0275nextContext"](2).editDept(t)}),o["\u0275\u0275element"](1,"img",39),o["\u0275\u0275elementEnd"]()}}function g(e,t){if(1&e){const e=o["\u0275\u0275getCurrentView"]();o["\u0275\u0275elementStart"](0,"button",40),o["\u0275\u0275listener"]("click",function(){o["\u0275\u0275restoreView"](e);const t=o["\u0275\u0275nextContext"]().$implicit;return o["\u0275\u0275nextContext"](2).delete(t)}),o["\u0275\u0275element"](1,"img",41),o["\u0275\u0275elementEnd"]()}}function u(e,t){if(1&e&&(o["\u0275\u0275elementStart"](0,"tr"),o["\u0275\u0275elementStart"](1,"th",34),o["\u0275\u0275text"](2),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementStart"](3,"td"),o["\u0275\u0275text"](4),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementStart"](5,"td"),o["\u0275\u0275text"](6),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementStart"](7,"td"),o["\u0275\u0275text"](8),o["\u0275\u0275pipe"](9,"date"),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementStart"](10,"td",35),o["\u0275\u0275template"](11,c,2,0,"button",36),o["\u0275\u0275template"](12,g,2,0,"button",37),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit,n=o["\u0275\u0275nextContext"](2);o["\u0275\u0275advance"](2),o["\u0275\u0275textInterpolate"](e.name),o["\u0275\u0275advance"](2),o["\u0275\u0275textInterpolate"](e.organization.name||"ROOT"),o["\u0275\u0275advance"](2),o["\u0275\u0275textInterpolate"](e.branch.name),o["\u0275\u0275advance"](2),o["\u0275\u0275textInterpolate"](o["\u0275\u0275pipeBind1"](9,6,e.creationDate)||"-"),o["\u0275\u0275advance"](3),o["\u0275\u0275property"]("ngIf",n.permissions.indexOf("canUpdateDepartment")>=0),o["\u0275\u0275advance"](1),o["\u0275\u0275property"]("ngIf",n.permissions.indexOf("canDeleteDepartment")>=0)}}const b=function(e,t,n){return{itemsPerPage:e,currentPage:t,totalItems:n}};function h(e,t){if(1&e){const e=o["\u0275\u0275getCurrentView"]();o["\u0275\u0275elementStart"](0,"div",21),o["\u0275\u0275elementStart"](1,"h4",22),o["\u0275\u0275text"](2,"DEPARTMENT | MANAGE"),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementStart"](3,"div",23),o["\u0275\u0275listener"]("click",function(){return o["\u0275\u0275restoreView"](e),o["\u0275\u0275nextContext"]().openDepartmentPopUp()}),o["\u0275\u0275template"](4,p,2,0,"button",24),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementStart"](5,"div"),o["\u0275\u0275elementStart"](6,"table",25),o["\u0275\u0275elementStart"](7,"thead"),o["\u0275\u0275elementStart"](8,"tr"),o["\u0275\u0275elementStart"](9,"th",26),o["\u0275\u0275text"](10,"Name"),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementStart"](11,"th",27),o["\u0275\u0275text"](12,"Organization"),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementStart"](13,"th",28),o["\u0275\u0275text"](14,"Branch"),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementStart"](15,"th",28),o["\u0275\u0275text"](16,"Created At"),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementStart"](17,"th",29),o["\u0275\u0275text"](18,"Actions"),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementStart"](19,"tbody"),o["\u0275\u0275template"](20,u,13,8,"tr",30),o["\u0275\u0275pipe"](21,"paginate"),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementStart"](22,"pagination-controls",31),o["\u0275\u0275listener"]("pageChange",function(t){return o["\u0275\u0275restoreView"](e),o["\u0275\u0275nextContext"]().getDeptList(t)}),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"](),o["\u0275\u0275element"](23,"br"),o["\u0275\u0275elementEnd"]()}if(2&e){const e=o["\u0275\u0275nextContext"]();o["\u0275\u0275advance"](4),o["\u0275\u0275property"]("ngIf",e.permissions.indexOf("canAddDepartment")>=0),o["\u0275\u0275advance"](16),o["\u0275\u0275property"]("ngForOf",o["\u0275\u0275pipeBind2"](21,2,e.deptList,o["\u0275\u0275pureFunction3"](5,b,e.deptPaginator.limit,e.deptPaginator.skip,e.deptPaginator.total)))}}function f(e,t){if(1&e&&(o["\u0275\u0275elementStart"](0,"option",42),o["\u0275\u0275text"](1),o["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;o["\u0275\u0275propertyInterpolate"]("value",e._id),o["\u0275\u0275advance"](1),o["\u0275\u0275textInterpolate1"](" ",e.name,"")}}function x(e,t){if(1&e&&(o["\u0275\u0275elementStart"](0,"button",43),o["\u0275\u0275text"](1,"Create Department"),o["\u0275\u0275elementEnd"]()),2&e){const e=o["\u0275\u0275nextContext"]();o["\u0275\u0275property"]("disabled",!e.departmentForm.valid)}}function S(e,t){1&e&&(o["\u0275\u0275elementStart"](0,"button",44),o["\u0275\u0275text"](1," Edit Department"),o["\u0275\u0275elementEnd"]())}const E=[{path:"",component:(()=>{class e{constructor(e,t,n,r){this.authService=e,this.toastr=t,this.fb=n,this.sharingService=r,this.permissions=[],this.deptPaginator={limit:10,skip:1,total:0},$("#org-dropdown-navbar").prop("disabled",!1),this.formInit(""),this.sharingSubscription=this.sharingService.currentOrgId.subscribe(e=>{this.orgId=e,this.formInit(e),this.getdeptList(1),this.getBranchList()})}ngAfterViewInit(){let e=this;setTimeout(function(){e.orgId=$("#org-dropdown-navbar").attr("value"),e.orgId&&(e.formInit(e.orgId),e.getdeptList(1),e.getBranchList())},300)}ngOnInit(){this.permissions=JSON.parse(localStorage.getItem("permissions"))}ngOnDestroy(){var e,t;this.sharingSubscription.unsubscribe(),this.branchListSubscription.unsubscribe(),this.deptListSubscription.unsubscribe(),null===(e=this.addDeptSubscription)||void 0===e||e.unsubscribe(),null===(t=this.editDeptSubscription)||void 0===t||t.unsubscribe()}formInit(e){this.departmentForm=this.fb.group({organization:[e,i.Validators.required],name:["",i.Validators.required],branch:["",i.Validators.required]})}getdeptList(e){this.departmentForm.patchValue({organization:this.orgId}),this.deptPaginator.skip=e,this.deptListSubscription=this.authService.getDepartmentList(this.orgId,{skip:this.deptPaginator.skip,limit:this.deptPaginator.limit}).subscribe(e=>{e.success?(this.deptList=e.data,this.deptPaginator.total=e.total):this.toastr.error(e.message,"Error!")},()=>{this.toastr.error("Something went wrong","Error!")})}getBranchList(){this.branchListSubscription=this.authService.getBranchList(this.orgId).subscribe(e=>{e.success?this.branchList=e.data:this.toastr.error(e.message,"Error!")},()=>{this.toastr.error("Something went wrong","Error!")})}addDept(e){this.addDeptSubscription=this.authService.addDepartment(e).subscribe(e=>{e.success?(this.toastr.success(e.message,"Success!"),this.clearDepartmentForm(),this.getdeptList(1)):(this.clearDepartmentForm(),this.toastr.error(e.message,"Error!"))},()=>{this.clearDepartmentForm(),this.toastr.error("Something went wrong","Error!")})}clearDepartmentForm(){$("#editDeptModal").modal("hide"),$("#addDeptModal").modal("hide"),this.departmentForm.reset(),this.formInit(this.orgId)}editDept(e){this.departmentForm.reset(),e&&(this.deptId=e._id,this.branch=e.branch,this.departmentForm.patchValue({name:e.name,organization:e.organization._id}),$("#editDeptModal").modal("show"))}updateDept(e){e.branch=this.branch,this.editDeptSubscription=this.authService.updateDepartment(e,this.deptId).subscribe(e=>{e.success?(this.toastr.success("Department Edited","Success!"),this.clearDepartmentForm(),this.getdeptList(this.deptPaginator.skip)):(this.clearDepartmentForm(),this.toastr.error(e.message,"Error!"))},()=>{this.clearDepartmentForm(),this.toastr.error("Something went wrong","Error!")})}delete(e){e&&(this.deptId=e._id,this.departmentName=e.name,$("#deleteModal").modal("show"))}deleteDepartment(){this.deleteDepartmentSubscription=this.authService.deleteDepartment(this.deptId).subscribe(e=>{e.success?(this.toastr.success("Department Deleted","Success!"),$("#deleteModal").modal("hide"),this.getdeptList(this.deptPaginator.skip)):this.toastr.error(e.message,"Error!")},()=>{this.toastr.error("Something went wrong","Error!")})}openDepartmentPopUp(){this.departmentForm.patchValue({organization:this.orgId,name:""}),$("#addDeptModal").modal("show")}}return e.\u0275fac=function(t){return new(t||e)(o["\u0275\u0275directiveInject"](d.a),o["\u0275\u0275directiveInject"](s.b),o["\u0275\u0275directiveInject"](i.FormBuilder),o["\u0275\u0275directiveInject"](l.a))},e.\u0275cmp=o["\u0275\u0275defineComponent"]({type:e,selectors:[["app-department"]],decls:63,vars:7,consts:[["class","container-fluid",4,"ngIf"],["id","addDeptModal","tabindex","-1","role","dialog","aria-labelledby","addDeptModalLabel","aria-hidden","true",1,"modal","fade"],["role","document",1,"modal-dialog"],[1,"modal-content"],[1,"container"],[1,"heading"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[3,"formGroup","ngSubmit"],[2,"margin-top","5px"],[1,"required"],["placeholder","Enter department name","formControlName","name","required","",1,"input-field"],["id","branch","formControlName","branch","required","",1,"dropdown"],["value","","disabled","","selected",""],[3,"value",4,"ngFor","ngForOf"],["type","submit","class","btn btn-sm btn-primary",3,"disabled",4,"ngIf"],["id","editDeptModal","tabindex","-1","role","dialog","aria-labelledby","editDeptModalLabel","aria-hidden","true",1,"modal","fade"],["type","submit","class","btn btn-sm btn-primary",4,"ngIf"],["id","deleteModal","tabindex","-1","role","dialog","aria-labelledby","deleteModalLabel","aria-hidden","true",1,"modal","fade"],["type","button","data-dismiss","modal",1,"btn-sm","btn","delete-btn","btn-light"],["type","button",1,"btn-sm","btn","delete-btn","btn-primary",3,"click"],[1,"container-fluid"],[1,"text-uppercase","header"],[1,"rel-action",3,"click"],["class","btn add-btn","title","Add Department",4,"ngIf"],[1,"table","table-bordered"],["scope","col",2,"width","20%"],["scope","col",2,"width","22%"],["scope","col"],["scope","col",1,"text-right","pull-right"],[4,"ngFor","ngForOf"],[3,"pageChange"],["title","Add Department",1,"btn","add-btn"],["src","assets/images/plus-icon.svg","height","35px;"],["scope","row"],[1,"text-right","pull-right"],["class","btn btn-sm btn-warning mar-5-left","title","Edit Department",3,"click",4,"ngIf"],["class","btn btn-sm btn-danger mar-5-left","title","Delete Department",3,"click",4,"ngIf"],["title","Edit Department",1,"btn","btn-sm","btn-warning","mar-5-left",3,"click"],["src","assets/images/edit-icon.svg"],["title","Delete Department",1,"btn","btn-sm","btn-danger","mar-5-left",3,"click"],["src","assets/images/trash.svg"],[3,"value"],["type","submit",1,"btn","btn-sm","btn-primary",3,"disabled"],["type","submit",1,"btn","btn-sm","btn-primary"]],template:function(e,t){1&e&&(o["\u0275\u0275template"](0,h,24,9,"div",0),o["\u0275\u0275elementStart"](1,"div",1),o["\u0275\u0275elementStart"](2,"div",2),o["\u0275\u0275elementStart"](3,"div",3),o["\u0275\u0275elementStart"](4,"div",4),o["\u0275\u0275elementStart"](5,"h6",5),o["\u0275\u0275text"](6,"DEPARTMENT | NEW"),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementStart"](7,"button",6),o["\u0275\u0275elementStart"](8,"span",7),o["\u0275\u0275text"](9,"\xd7"),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"](),o["\u0275\u0275element"](10,"hr"),o["\u0275\u0275elementStart"](11,"form",8),o["\u0275\u0275listener"]("ngSubmit",function(){return t.addDept(t.departmentForm.value)}),o["\u0275\u0275elementStart"](12,"div",9),o["\u0275\u0275elementStart"](13,"label",10),o["\u0275\u0275text"](14,"Name"),o["\u0275\u0275elementEnd"](),o["\u0275\u0275element"](15,"input",11),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementStart"](16,"div",9),o["\u0275\u0275elementStart"](17,"label",10),o["\u0275\u0275text"](18,"Branch"),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementStart"](19,"select",12),o["\u0275\u0275elementStart"](20,"option",13),o["\u0275\u0275text"](21,"Select Branch"),o["\u0275\u0275elementEnd"](),o["\u0275\u0275template"](22,f,2,2,"option",14),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"](),o["\u0275\u0275element"](23,"hr"),o["\u0275\u0275template"](24,x,2,1,"button",15),o["\u0275\u0275elementEnd"](),o["\u0275\u0275element"](25,"br"),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementStart"](26,"div",16),o["\u0275\u0275elementStart"](27,"div",2),o["\u0275\u0275elementStart"](28,"div",3),o["\u0275\u0275elementStart"](29,"div",4),o["\u0275\u0275elementStart"](30,"h6",5),o["\u0275\u0275text"](31,"DEPARTMENT | EDIT"),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementStart"](32,"button",6),o["\u0275\u0275elementStart"](33,"span",7),o["\u0275\u0275text"](34,"\xd7"),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"](),o["\u0275\u0275element"](35,"hr"),o["\u0275\u0275elementStart"](36,"form",8),o["\u0275\u0275listener"]("ngSubmit",function(){return t.updateDept(t.departmentForm.value)}),o["\u0275\u0275elementStart"](37,"div",9),o["\u0275\u0275elementStart"](38,"label",10),o["\u0275\u0275text"](39,"Name"),o["\u0275\u0275elementEnd"](),o["\u0275\u0275element"](40,"input",11),o["\u0275\u0275elementEnd"](),o["\u0275\u0275element"](41,"hr"),o["\u0275\u0275template"](42,S,2,0,"button",17),o["\u0275\u0275elementEnd"](),o["\u0275\u0275element"](43,"br"),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementStart"](44,"div",18),o["\u0275\u0275elementStart"](45,"div",2),o["\u0275\u0275elementStart"](46,"div",3),o["\u0275\u0275elementStart"](47,"div",4),o["\u0275\u0275elementStart"](48,"h6",5),o["\u0275\u0275text"](49,"DEPARTMENT | DELETE"),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementStart"](50,"button",6),o["\u0275\u0275elementStart"](51,"span",7),o["\u0275\u0275text"](52,"\xd7"),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"](),o["\u0275\u0275element"](53,"hr"),o["\u0275\u0275elementStart"](54,"label"),o["\u0275\u0275text"](55),o["\u0275\u0275elementEnd"](),o["\u0275\u0275element"](56,"br"),o["\u0275\u0275elementStart"](57,"button",19),o["\u0275\u0275text"](58,"No"),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementStart"](59,"button",20),o["\u0275\u0275listener"]("click",function(){return t.deleteDepartment()}),o["\u0275\u0275text"](60,"Yes"),o["\u0275\u0275elementEnd"](),o["\u0275\u0275element"](61,"br"),o["\u0275\u0275element"](62,"br"),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"]()),2&e&&(o["\u0275\u0275property"]("ngIf",t.permissions&&t.permissions.length),o["\u0275\u0275advance"](11),o["\u0275\u0275property"]("formGroup",t.departmentForm),o["\u0275\u0275advance"](11),o["\u0275\u0275property"]("ngForOf",t.branchList),o["\u0275\u0275advance"](2),o["\u0275\u0275property"]("ngIf",t.permissions.indexOf("canAddDepartment")>=0),o["\u0275\u0275advance"](12),o["\u0275\u0275property"]("formGroup",t.departmentForm),o["\u0275\u0275advance"](6),o["\u0275\u0275property"]("ngIf",t.permissions.indexOf("canUpdateDepartment")>=0),o["\u0275\u0275advance"](13),o["\u0275\u0275textInterpolate1"]("Do you want to delete this department- ",t.departmentName,"?"))},directives:[r.NgIf,i["\u0275angular_packages_forms_forms_y"],i.NgControlStatusGroup,i.FormGroupDirective,i.DefaultValueAccessor,i.NgControlStatus,i.FormControlName,i.RequiredValidator,i.SelectControlValueAccessor,i.NgSelectOption,i["\u0275angular_packages_forms_forms_x"],r.NgForOf,m.c],pipes:[m.b,r.DatePipe],styles:[".rel-action[_ngcontent-%COMP%]{position:absolute;right:20px;top:80px}.rel-action[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#fff;font-size:20px;line-height:2.8;text-decoration:none}.rel-action[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{text-decoration:none;cursor:pointer}.add-btn[_ngcontent-%COMP%]{margin-top:15px}.add-btn[_ngcontent-%COMP%]:focus{box-shadow:none!important}.btn-warning[_ngcontent-%COMP%]{background-color:#ffd75f;border-color:#ffd75f}.btn-warning[_ngcontent-%COMP%]:hover{background-color:#ffc516;border-color:#ffc516}.btn-warning[_ngcontent-%COMP%]:focus{box-shadow:none!important}.btn-danger[_ngcontent-%COMP%]{background-color:#fe3b3b;border-color:#fe3b3b}.btn-danger[_ngcontent-%COMP%]:hover{background-color:#eb1f33;border-color:#eb1f33}.btn-danger[_ngcontent-%COMP%]:focus, .delete-btn[_ngcontent-%COMP%]{box-shadow:none!important}.delete-btn[_ngcontent-%COMP%]{margin-left:5px;padding:5px 20px;margin-top:10px}.btn-light[_ngcontent-%COMP%]{background-color:#e4e5e5;border-color:#e4e5e5}.main-container[_ngcontent-%COMP%]{box-shadow:0 4px 10px 0 #d3d3d3!important;margin-top:9%!important;padding:0!important}thead[_ngcontent-%COMP%]{background:#f5f5f5}th[_ngcontent-%COMP%]{width:20%;padding-left:25px}td[_ngcontent-%COMP%]{padding-left:25px!important;padding:.65rem}p[_ngcontent-%COMP%]{margin-bottom:.1rem}.container[_ngcontent-%COMP%]{padding-right:25px;padding-left:25px;box-shadow:0 4px 5px 0 grey;padding-top:20px;margin-top:1%}.heading[_ngcontent-%COMP%], .page-heading[_ngcontent-%COMP%]{font-weight:700}.page-heading[_ngcontent-%COMP%]{padding-left:20px;font-size:17px}.close[_ngcontent-%COMP%]{position:relative;bottom:32px}label[_ngcontent-%COMP%]{color:grey;font-size:14px;font-weight:600;padding-left:5px}.input-field[_ngcontent-%COMP%]:focus{outline:none}.cursor-pointer[_ngcontent-%COMP%]{cursor:pointer}.dropdown[_ngcontent-%COMP%]{width:100%;height:33px;border:1px solid #d3d3d3;border-radius:3px;color:grey;padding-left:6px;font-size:13px}.dropdown[_ngcontent-%COMP%]:focus{outline:none}"]}),e})()}];let v=(()=>{class e{}return e.\u0275mod=o["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=o["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[a.i.forChild(E)],a.i]}),e})(),D=(()=>{class e{}return e.\u0275mod=o["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=o["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[r.CommonModule,v,i.ReactiveFormsModule,m.a]]}),e})()}}]);